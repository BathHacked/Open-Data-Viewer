(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(e,t,a){},145:function(e,t,a){},184:function(e,t,a){},203:function(e,t,a){},205:function(e,t,a){},207:function(e,t,a){},209:function(e,t,a){},211:function(e,t,a){},213:function(e,t,a){"use strict";a.r(t);a(91),a(126);var n=a(0),o=a.n(n),r=a(54),i=a.n(r),s=(a(131),a(89)),l=a(16),c=a(83),m=a(17),u=a(18),d=a(20),h=a(19),p=a(21),f=a(1),v=a(2),b=a.n(v),y=a(55),g=(a(143),a(145),a(147),a(80),"B&NES"),E="Local Services",N="This map can help you find the location of useful local services in Bath & North East Somerset.",w={center:[51.38257,-2.3587],zoom:13,attributionControl:!0,zoomControl:!1,maxBounds:[[51.2,-2.651138],[51.5,-2.204475]]},T={uri:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",params:{minZoom:11,attribution:"&copy; OpenStreetMap contributors &amp; <a href=&quot;https://wikimediafoundation.org/wiki/Maps_Terms_of_Use&quot;>Wikimedia</a>",id:"",accessToken:""}},k={viewbox:"-2.744865,51.253106,-2.110405,51.457216",bounded:1,limit:10},O=[{Name:"councilAdvice",Title:"Council Help & Advice ",Headline:"Shows the location of council advice centres",Description:"Shows the location of council advice centres",Author:"Leigh Dodds",AttributeTags:[{attributeName:"Council Advice",attributeTag:"advice_service",attributeValues:["citizens_advice"],icon:"hands-helping"}],overpassQuery:'[out:json];        (way["amenity"="advice_service"](around:20000,51.38257, -2.35870);        node["amenity"="advice_service"](around:20000,51.38257, -2.35870););        out body;>;out skel qt;',mapConfig:{mapIcon:"hands-helping",color:"blue"}},{Name:"food",Title:"Community Food Provision",Headline:"Shows the location of local food banks and community kitchens",Description:"Shows the location of local food banks and community kitchens",Author:"Leigh Dodds",AttributeTags:[{attributeName:"Food Bank",attributeTag:"social_facility",attributeValues:["food_bank"],icon:"shopping-basket"},{attributeName:"Community Kitchen",attributeTag:"social_facility",attributeValues:["soup_kitchen"],icon:"utensils"},{attributeName:"Information",type:"description",attributeTag:"description",attributeValues:[],icon:"info-circle",iconColor:"#6495ED"}],overpassQuery:'[out:json];        (way["social_facility"~"(food_bank|soup_kitchen)$"](around:20000,51.38257, -2.35870);        node["social_facility"~"(food_bank|soup_kitchen)$"](around:20000,51.38257, -2.35870););        out body;>;out skel qt;',mapConfig:{mapIcon:"utensils",color:"orange"}},{Name:"recycling",Title:"Recycling Centres",Headline:"Shows the location of recycling centres",Description:"Shows the location of recycling centres",Author:"Leigh Dodds",AttributeTags:[],overpassQuery:'[out:json];        (way["recycling_type"="centre"](around:20000,51.38257, -2.35870);        node["recycling_type"="centre"](around:20000,51.38257, -2.35870););        out body;>;out skel qt;',mapConfig:{mapIcon:"recycle",color:"green"}},{Name:"digitalAccess",Title:"Community Digital Access",Headline:"Shows community locations that provides access to digital Services",Description:"This theme shows community locations that provide access to digital services.  These include access to printing facilities, access to computers for public use and Wifi / internet access",Author:"Leigh Dodds",AttributeTags:[{attributeName:"Internet Access",attributeTag:"internet_access",attributeValues:["wlan","yes","terminal","wifi","service"],icon:"wifi"},{attributeName:"Printing Facilities",attributeTag:"digital_access",attributeValues:["printer"],icon:"print"},{attributeName:"Computer Access",attributeTag:"digital_access",attributeValues:["computer"],icon:"desktop"},{attributeName:"Membership Required",attributeTag:"digital_access:membership",attributeValues:["yes"],icon:"exclamation",iconColor:"red"}],overpassQuery:'[out:json];        (way["amenity"~"(library|community_centre)$"][~"^(internet_access|digital_access)$"~"."](around:20000,51.38257, -2.35870);        node["amenity"~"(library|community_centre)$"][~"^(internet_access|digital_access)$"~"."](around:20000,51.38257, -2.35870););        out body;>;out skel qt;',mapConfig:{mapIcon:"wifi",color:"red"}}],C=a(36),S=a.n(C),j=a(84),L=a(85),_=a.n(L),x=a(86),M=a.n(x),A=function(){var e=Object(j.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){_()(t).then(function(t){var a,n=(a={elements:t},M()(a,{flatProperties:!0}));e(n)}).catch(function(e){console.error(e),a("Error: the overpass API request was not completed")})}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),D=a(87),I=a.n(D);a(184);function P(e){var t=function(e){var t=new Map;t.set("housenumber",null),t.set("street",null),t.set("place",null),t.set("city",null),t.set("postcode",null);var a=["housenumber","street","place","city","postcode"];Object.keys(e).forEach(function(n){var o=n.split(":")[1];a.includes(o)&&t.set(o,e[n])});var n=[],o=!0,r=!1,i=void 0;try{for(var s,l=t.values()[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;null!=c&&n.push(c)}}catch(m){r=!0,i=m}finally{try{o||null==l.return||l.return()}finally{if(r)throw i}}return n.join(", ")}(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement("h6",{className:"mb-0"},e.name),t&&o.a.createElement("p",{className:"mb-1 mt-0 text-muted"},t,o.a.createElement("br",null)))}function V(e){var t=!!(e.phone||e.website||e.wheelchair);if(!t)return null;var a=o.a.createElement(o.a.Fragment,null,e.phone&&o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-phone service-icon"}),o.a.createElement("span",null,e.phone)),e.website&&o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-globe-europe service-icon"}),o.a.createElement("span",null,o.a.createElement("a",{href:e.website,target:"_blank",rel:"noopener noreferrer"},"Website"))));return o.a.createElement("div",{className:"pt-2"}," ",t&&o.a.createElement("a",{className:"text-decoration-none text-reset","data-toggle":"collapse",href:"#featureDetails"},o.a.createElement("em",null,"Details"),o.a.createElement("span",{className:"fa fa-chevron-down service-icon"})),o.a.createElement("div",{className:"collapse",id:"featureDetails"},o.a.createElement("table",{className:"table-sm"},a),o.a.createElement(q,e)))}function J(e){var t=e.opening_hours?e.opening_hours.split(";"):null,a=e.service_times?e.service_times.split(";"):null;a&&(t=a);var n=null;return t&&(n=1===t.length?o.a.createElement("tr",null,o.a.createElement("td",{className:"opening-times-td"},t[0])):t.map(function(e){var a=e.trim().split(" "),n=a[0],r=a[1];return o.a.createElement("tr",{key:"open + ".concat(t.indexOf(e))},o.a.createElement("td",{className:"opening-times-td"},n),o.a.createElement("td",{className:"opening-times-td"},r))})),o.a.createElement("div",{className:"pt-2"}," ",t&&o.a.createElement("div",null,o.a.createElement("a",{className:"text-decoration-none text-reset","data-toggle":"collapse",href:"#address"},o.a.createElement("em",null,"Opening Times"),o.a.createElement("span",{className:"fa fa-chevron-down service-icon"}))),o.a.createElement("div",{className:"collapse",id:"address"},o.a.createElement("table",{className:"table-sm"},n)))}function F(e){var t=[],a=!0,n=!1,r=void 0;try{for(var i,s=e.theme.AttributeTags[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var l=i.value,c=e.props[l.attributeTag];if(c){var m=c.split(";"),u=l.attributeValues,d=l.type,h=!1;if(0===u.length)h=!0;else{var p=!0,f=!1,v=void 0;try{for(var b,y=m[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var g=b.value;if(u.includes(g.toLowerCase())){h=!0;break}}}catch(N){f=!0,v=N}finally{try{p||null==y.return||y.return()}finally{if(f)throw v}}}if(h){var E=o.a.createElement("div",{className:"pt-1",key:l.attributeName},d&&"description"===d?o.a.createElement("div",{className:"media"},o.a.createElement("div",{className:"feature-icon-container d-flex justify-content-center"},o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-".concat(l.icon),style:{color:l.iconColor}}))),o.a.createElement("div",{className:"media-body"},c)):o.a.createElement("div",{className:"media"},o.a.createElement("div",{className:"feature-icon-container d-flex justify-content-center"},o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-".concat(l.icon," icon-centre"),style:{color:l.iconColor}}))),o.a.createElement("div",{className:"media-body"},l.attributeName)));t.push(E)}}}}catch(N){n=!0,r=N}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return t.length>0?o.a.createElement("div",{className:"pt-1"},o.a.createElement("div",null,o.a.createElement("em",null,e.theme.Title),o.a.createElement("br",null),t)):null}function q(e){var t=e.wheelchair;return t?o.a.createElement("div",null,"yes"===t.toLowerCase()&&o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-wheelchair service-icon wheelchair-access"}),o.a.createElement("span",null,"Wheelchair Accessible")),"no"===t.toLowerCase()&&o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-wheelchair service-icon wheelchair-no-access"}),o.a.createElement("span",null,"No wheelchair access")),"limited"===t.toLowerCase()&&o.a.createElement("div",null,o.a.createElement("span",{className:"fa fa-wheelchair service-icon wheelchair-partial-access"}),o.a.createElement("span",null,"Limited wheelchair access"))):null}function z(e,t){var a=o.a.createElement("div",null,o.a.createElement(P,e),o.a.createElement(F,{props:e,theme:t}),o.a.createElement(V,e),o.a.createElement(J,e));return I.a.renderToString(a)}var B=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).mapNode=null,a.map=null,a.geoJSONLayers={},a.loadingTheme=null,a.setTheme=a.setTheme.bind(Object(f.a)(Object(f.a)(a))),a.updateMapThemes=a.updateMapThemes.bind(Object(f.a)(Object(f.a)(a))),a.createCustomMarker=a.createCustomMarker.bind(Object(f.a)(Object(f.a)(a))),a.bindCustomPopup=a.bindCustomPopup.bind(Object(f.a)(Object(f.a)(a))),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.init(this.mapNode)}},{key:"componentDidUpdate",value:function(){this.props.themeToggle&&this.updateMapThemes()}},{key:"init",value:function(e){var t=this;this.map=b.a.map(e,w),b.a.control.scale({position:"bottomright"}).addTo(this.map),b.a.control.zoom({position:"topright"}).addTo(this.map),b.a.tileLayer(T.uri,T.params).addTo(this.map);var a=this.setResetZoom();this.map.addControl(a);var n=this.setLocationSearch();this.map.addControl(n),this.props.themes.forEach(function(e){t.setTheme(e)})}},{key:"setLocationSearch",value:function(){var e=k,t=new y.OpenStreetMapProvider({params:e});return new y.GeoSearchControl({provider:t,style:"button",position:"topright",searchLabel:"Search for a location or feature",autoClose:!0,keepResult:!0})}},{key:"setResetZoom",value:function(){var e=new b.a.Control({position:"topright"});return e.onAdd=function(e){var t=b.a.DomUtil.create("div","leaflet-control-zoom leaflet-bar leaflet-control"),a=b.a.DomUtil.create("a","leaflet-control-zoom fa fa-globe fa-2x",t);return a.title="Reset Map View",b.a.DomEvent.addListener(a,"click",function(){e.setView(e.options.center,e.options.zoom)},a),t},e}},{key:"setTheme",value:function(e){var t=this;A(e.overpassQuery).then(function(a){t.setMaps(a,e)}).catch(function(e){console.error(e)})}},{key:"setMaps",value:function(e,t){var a=this;this.loadingTheme=t,this.geoJSONLayers[t.Name]=b.a.geoJSON(e,{onEachFeature:this.bindCustomPopup,pointToLayer:this.createCustomMarker}),this.createGeoJSONPoints(this.geoJSONLayers[t.Name]).forEach(function(e){e.eachLayer(function(e){a.geoJSONLayers[t.Name].addLayer(e)})}),this.geoJSONLayers[t.Name].addTo(this.map),this.props.dataLoaded(t)}},{key:"createGeoJSONPoints",value:function(e){var t=this,a=[];return e.eachLayer(function(e){if("Polygon"===e.feature.geometry.type){var n=e.feature.properties,o=e.getBounds().getCenter(),r=new b.a.marker(o).toGeoJSON(),i=b.a.geoJSON(r,{pointToLayer:t.createCustomMarker,onEachFeature:function(e,a){a.feature.properties=n,e.properties.name&&a.bindPopup(z(a.feature.properties,t.loadingTheme))}});a.push(i)}}),a}},{key:"createCustomMarker",value:function(e,t){var a=b.a.AwesomeMarkers.icon({icon:this.loadingTheme.mapConfig.mapIcon,markerColor:this.loadingTheme.mapConfig.color,prefix:"fa"});return b.a.marker(t,{icon:a})}},{key:"bindCustomPopup",value:function(e,t){"Polygon"!==t.feature.geometry.type&&e.properties.name&&t.bindPopup(z(t.feature.properties,this.loadingTheme))}},{key:"updateMapThemes",value:function(){var e=Object.keys(this.props.themeToggle)[0];if(this.props.themeToggle[e])try{this.map.addLayer(this.geoJSONLayers[e])}catch(t){}else try{this.map.removeLayer(this.geoJSONLayers[e])}catch(t){}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"page-wrap"},o.a.createElement("div",{ref:function(t){return e.mapNode=t},id:"map"}),";")}}]),t}(o.a.Component),$=a(88),R=(a(203),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).switchTheme=a.switchTheme.bind(Object(f.a)(Object(f.a)(a))),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"switchTheme",value:function(e){var t=this.props.themeToggle[e];this.props.updateAppTheme(Object(l.a)({},e,!t))}},{key:"generateMenuItems",value:function(){var e=this;return this.props.themes.map(function(t){return o.a.createElement("div",{className:"menu-item",key:"{'menuItem' + this.props.themes.indexOf(theme)}"},o.a.createElement("div",{className:e.props.themeToggle[t.Name]?"theme-active media":"theme-disable media",onClick:function(a){return e.switchTheme(t.Name)},"data-id":t.Name},o.a.createElement("div",{className:"align-self-end mr-3 awesome-marker-icon-".concat(t.mapConfig.color," awesome-marker")},o.a.createElement("i",{className:"fa fa-".concat(t.mapConfig.mapIcon," icon-white fa-inverse")})),o.a.createElement("div",{className:"media-body"},o.a.createElement("h6",{className:"mt-2 active"},t.Title))))})}},{key:"render",value:function(){return o.a.createElement($.slide,{noOverlay:!0},o.a.createElement("div",{className:"menu-item"},o.a.createElement("h4",{className:"theme-active"},"Our Services")),this.generateMenuItems())}}]),t}(o.a.Component)),W=(a(205),function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("nav",{className:"navbar fixed-top navbar-expand-sm navbar-dark navbar-component-top navbar-style"},o.a.createElement("button",{className:"navbar-brand btn btn-unstyled navbar-btn-style"},g,o.a.createElement("span",{className:"secondary-title"}," - ",E)),o.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"})),o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"nav-item"},o.a.createElement("button",{type:"button",className:"btn btn-unstyled navbar-btn-style","data-toggle":"modal","data-target":"#infoModal"},"About ",o.a.createElement("span",{className:"fa fa-info-circle"}))),o.a.createElement("li",{className:"nav-item"},o.a.createElement("button",{type:"button",className:"btn btn-unstyled navbar-btn-style","data-toggle":"modal","data-target":"#themeModal"},"Map Themes"))))))}),H=(a(207),a(209),function(e){return o.a.createElement(o.a.Fragment,null,e.showSpinner&&o.a.createElement("div",{className:"spinner-border text-secondary spinner-center",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading...")))}),Q=function(){return o.a.createElement("div",{className:"modal fade",id:"infoModal",tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h4",{className:"modal-title font-weight-bold",id:"modalTitle"},g," - ",E),o.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"modal-body"},o.a.createElement("p",null,N),o.a.createElement("p",null,"You can use the menu on the left hand side of the screen to select the type of service you would like to see and these will be highlighted on the map. Simply click on a point on the map to view the details of that service including its address and opening times."),o.a.createElement("p",null,o.a.createElement("strong",null,"Disclaimer")," \u2013 This map has been developed as a community tool. B&NES Council doesn\u2019t endorse or verify the services displayed and would encourage users to contact individual services directly for more information. If you have any questions, comments or feedback please get in touch.")),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal"},"Close")))))},G=(a(211),function(e){var t=e.themes&&e.themes.map(function(t){return o.a.createElement("div",{className:"media",key:"mapThemesModal + ".concat(e.themes.indexOf(t))},o.a.createElement("div",{className:"icon-container"},o.a.createElement("span",{className:"fa fa-2x fa-".concat(t.mapConfig.mapIcon," align-self-start")})),o.a.createElement("div",{className:"media-body"},o.a.createElement("h5",{className:"font-weight-bold"},t.Title),o.a.createElement("p",null,t.Description)))});return o.a.createElement("div",{className:"modal fade",id:"themeModal",tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle","aria-hidden":"true"},o.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("div",{className:"modal-header"},o.a.createElement("h5",{className:"modal-title font-weight-bold",id:"modalTitle"},"Map Themes"),o.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),o.a.createElement("div",{className:"modal-body"},t),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal"},"Close")))))}),U=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={themeVisibility:{},themeToggle:{},dataLoaded:!1,loadedThemes:[]},a.appThemes=O,a.setThemeState=a.setThemeState.bind(Object(f.a)(Object(f.a)(a))),a.onDataLoad=a.onDataLoad.bind(Object(f.a)(Object(f.a)(a))),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"setThemeState",value:function(e){this.setState({themeVisibility:Object(c.a)({},this.state.themeVisibility,e),themeToggle:e})}},{key:"onDataLoad",value:function(e){this.setState({dataLoaded:!0}),this.setThemeState(Object(l.a)({},e.Name,!0)),this.setState({loadedThemes:[].concat(Object(s.a)(this.state.loadedThemes),[e])})}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Q,null),o.a.createElement(G,{themes:this.state.loadedThemes}),o.a.createElement(W,null),o.a.createElement(R,{updateAppTheme:this.setThemeState,themes:this.state.loadedThemes,themeToggle:this.state.themeVisibility}),o.a.createElement(H,{showSpinner:!this.state.dataLoaded}),o.a.createElement(B,{themes:this.appThemes,themeToggle:this.state.themeToggle,dataLoaded:this.onDataLoad}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},85:function(e,t,a){var n=a(151),o=a(166),r=a(168)({Promise:o}).fetch,i=a(169).stringify;e.exports=function(e){return n(function(){return r("https://overpass-api.de/api/interpreter?"+i({data:e}),{redirect:"follow",headers:{accept:"application/json"}}).then(function(e){if(!e.ok){var t=new Error(e.statusText);throw t.statusCode=e.status,t}return e.json()}).then(function(e){if(!e||!Array.isArray(e.elements))throw new Error("invalid response");return e.elements})},{minTimeout:500})}},90:function(e,t,a){e.exports=a(213)}},[[90,2,1]]]);
//# sourceMappingURL=main.a92c09c0.chunk.js.map